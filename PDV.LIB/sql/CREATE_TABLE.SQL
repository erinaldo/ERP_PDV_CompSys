CREATE TABLE PAIS (
  IDPAIS NUMERIC(18,0),
  CODIGO VARCHAR(50),
  DESCRICAO VARCHAR(150),
  PRIMARY KEY(IDPAIS)
);

CREATE TABLE FINALIDADE (
  IDFINALIDADE NUMERIC(18,0),
  CODIGO NUMERIC(5),
  DESCRICAO VARCHAR(250),
  PRIMARY KEY(IDFINALIDADE)
);

CREATE TABLE PERFILACESSO (
  IDPERFILACESSO NUMERIC(18,0),
  DESCRICAO VARCHAR(150),
  ATIVO NUMERIC(1),
  PRIMARY KEY(IDPERFILACESSO)
);

CREATE TABLE TIPOOPERACAO (
  IDTIPOOPERACAO NUMERIC(18,0),
  DESCRICAO VARCHAR(250),
  PRIMARY KEY(IDTIPOOPERACAO)
);

CREATE TABLE PORTARIA (
  IDPORTARIA NUMERIC(18,0),
  TITULO VARCHAR(250),
  DESCRICAO TEXT,
  PRIMARY KEY(IDPORTARIA)
);

CREATE TABLE ITEMMENU (
  IDITEMMENU NUMERIC(18,0),
  DESCRICAO VARCHAR(100),
  PRIMARY KEY(IDITEMMENU)
);

CREATE TABLE MARCA (
  IDMARCA NUMERIC(18,0),
  CODIGO VARCHAR(6),
  DESCRICAO VARCHAR(200),
  PRIMARY KEY(IDMARCA)
);

CREATE TABLE FORNECEDOR (
  IDFORNECEDOR NUMERIC(18,0),
  RAZAOSOCIAL VARCHAR(200),CNPJ VARCHAR(14),
  PRIMARY KEY(IDFORNECEDOR)
);

CREATE TABLE ORIGEMPRODUTO (
  IDORIGEMPRODUTO NUMERIC(18,0),
  CODIGO NUMERIC(2),
  DESCRICAO VARCHAR(250),
  PRIMARY KEY(IDORIGEMPRODUTO)
);

CREATE TABLE UNIDADEDEMEDIDA (
  IDUNIDADEDEMEDIDA NUMERIC(18,0),
  DESCRICAO VARCHAR(150),
  SIGLA VARCHAR(4),
  PRIMARY KEY(IDUNIDADEDEMEDIDA)
);

CREATE TABLE CSTPIS (
  IDCSTPIS NUMERIC(18,0),
  CST NUMERIC(5),
  DESCRICAO VARCHAR(250),
  PRIMARY KEY(IDCSTPIS)
);

CREATE TABLE TIPOATENDIMENTO (
  IDTIPOATENDIMENTO NUMERIC(18,0),
  CODIGO NUMERIC(5),
  DESCRICAO VARCHAR(250),
  PRIMARY KEY(IDTIPOATENDIMENTO)
);

CREATE TABLE COMANDA (
  IDCOMANDA NUMERIC(18,0),
  CODIGO VARCHAR(15),
  DESCRICAO VARCHAR(150),
  STATUS NUMERIC(1),
  CPF VARCHAR(15),
  PRIMARY KEY(IDCOMANDA)
);

CREATE TABLE CONFIGURACAO (
  IDCONFIGURACAO NUMERIC(18,0),
  CHAVE VARCHAR(200),
  VALOR BYTEA,
  PRIMARY KEY(IDCONFIGURACAO)
);

CREATE TABLE BANDEIRACARTAO (
  IDBANDEIRACARTAO NUMERIC(18,0),
  CODIGO NUMERIC(2),
  DESCRICAO VARCHAR(150),
  PRIMARY KEY(IDBANDEIRACARTAO)
);

CREATE TABLE CATEGORIA (
  IDCATEGORIA NUMERIC(18,0),
  CODIGO VARCHAR(6),
  DESCRICAO VARCHAR(200),
  PRIMARY KEY(IDCATEGORIA)
);

CREATE TABLE CFOP (
  IDCFOP NUMERIC(18,0),
  CODIGO VARCHAR(4),
  DESCRICAO TEXT,
  ATIVO NUMERIC(1),
  TIPO VARCHAR(1),
  PRIMARY KEY(IDCFOP)
);

CREATE TABLE CSTICMS (
  IDCSTICMS NUMERIC(18,0),
  CSTCSOSN NUMERIC(5),
  DESCRICAO VARCHAR(250),
  PRIMARY KEY(IDCSTICMS)
);

CREATE TABLE CSTIPI (
  IDCSTIPI NUMERIC(18,0),
  CST NUMERIC(5),
  DESCRICAO VARCHAR(250),
  PRIMARY KEY(IDCSTIPI)
);

CREATE TABLE CONTATO (
  IDCONTATO NUMERIC(18,0),
  EMAIL VARCHAR(100),
  EMAILALTERNATIVO VARCHAR(100),
  TELEFONE VARCHAR(11),
  CELULAR VARCHAR(11),
  PRIMARY KEY(IDCONTATO)
);

CREATE TABLE CSTCOFINS (
  IDCSTCOFINS NUMERIC(18,0),
  CST NUMERIC(5),
  DESCRICAO VARCHAR(250),
  PRIMARY KEY(IDCSTCOFINS)
);

CREATE TABLE UNIDADEFEDERATIVA (
  IDUNIDADEFEDERATIVA NUMERIC(18,0),
  IDPAIS NUMERIC(18),
  SIGLA VARCHAR(10),
  DESCRICAO VARCHAR(150),
  ALIQUOTAINTER NUMERIC(15,2),
  ALIQUOTAINTRA NUMERIC(15,2),
  FCP NUMERIC(15,2),
  PRIMARY KEY(IDUNIDADEFEDERATIVA),
  FOREIGN KEY(IDPAIS) REFERENCES PAIS(IDPAIS)
);

CREATE TABLE USUARIO (
  IDUSUARIO NUMERIC(18,0),
  IDUSUARIOSUPERVISOR NUMERIC(18,0),
  IDPERFILACESSO NUMERIC(18),
  NOME VARCHAR(150),
  LOGIN VARCHAR(50),
  SENHA VARCHAR(150),
  EMAIL VARCHAR(100),
  ATIVO NUMERIC(1),
  ROOT NUMERIC(1),
  PIN VARCHAR(150),
  PRIMARY KEY(IDUSUARIO),
  FOREIGN KEY(IDUSUARIOSUPERVISOR) REFERENCES USUARIO(IDUSUARIO),
  FOREIGN KEY(IDPERFILACESSO) REFERENCES PERFILACESSO(IDPERFILACESSO)
);

CREATE TABLE FORMADEPAGAMENTO (
  IDFORMADEPAGAMENTO NUMERIC(18,0),
  IDBANDEIRACARTAO NUMERIC(18),
  CODIGO NUMERIC(2),
  DESCRICAO VARCHAR(150),
  PRIMARY KEY(IDFORMADEPAGAMENTO),
  FOREIGN KEY(IDBANDEIRACARTAO) REFERENCES BANDEIRACARTAO(IDBANDEIRACARTAO)
);

CREATE TABLE PERFILACESSOITEMMENU (
  IDPERFILACESSOITEMMENU NUMERIC(18,0),
  IDITEMMENU NUMERIC(18),
  IDPERFILACESSO NUMERIC(18),
  PRIMARY KEY(IDPERFILACESSOITEMMENU),
  FOREIGN KEY(IDITEMMENU) REFERENCES ITEMMENU(IDITEMMENU),
  FOREIGN KEY(IDPERFILACESSO) REFERENCES PERFILACESSO(IDPERFILACESSO)
);

CREATE TABLE INTEGRACAOFISCAL (
  IDINTEGRACAOFISCAL NUMERIC(18,0),
  IDCFOP NUMERIC(18),
  IDTIPOOPERACAO NUMERIC(18,0),
  IDPORTARIA NUMERIC(18),
  IDCSTICMS NUMERIC(18),
  IDCSTIPI NUMERIC(18),
  IDCSTPIS NUMERIC(18),
  IDCSTCOFINS NUMERIC(18),
  DESCRICAO VARCHAR(250),
  SEQUENCIA NUMERIC(2),
  ICMS NUMERIC(1),
  ICMS_IPI NUMERIC(1),
  ICMS_ST NUMERIC(1),
  ICMS_RED NUMERIC(1),
  ICMS_REDST NUMERIC(1),
  ICMS_DIFERENCIADO NUMERIC(15,2),
  ICMS_CDIFERENCIADO NUMERIC(1),
  ICMS_ST_CDIFERENCIADO NUMERIC(1),
  ICMS_ST_DIFERENCIADO NUMERIC(15,2),
  ICMS_DIF NUMERIC(1),
  ESTOQUE NUMERIC(1),
  FINANCEIRO NUMERIC(1),
  PRIMARY KEY(IDINTEGRACAOFISCAL),
  FOREIGN KEY(IDPORTARIA) REFERENCES PORTARIA(IDPORTARIA),
  FOREIGN KEY(IDCSTICMS) REFERENCES CSTICMS(IDCSTICMS),
  FOREIGN KEY(IDCSTIPI) REFERENCES CSTIPI(IDCSTIPI),
  FOREIGN KEY(IDCSTPIS) REFERENCES CSTPIS(IDCSTPIS),
  FOREIGN KEY(IDCSTCOFINS) REFERENCES CSTCOFINS(IDCSTCOFINS),
  FOREIGN KEY(IDTIPOOPERACAO) REFERENCES TIPOOPERACAO(IDTIPOOPERACAO),
  FOREIGN KEY(IDCFOP) REFERENCES CFOP(IDCFOP)
);

CREATE TABLE MUNICIPIO (
  IDMUNICIPIO NUMERIC(18,0),
  IDUNIDADEFEDERATIVA NUMERIC(18),
  MESORREGIAOGEOGRAFICA NUMERIC(11),
  NOMEMESORREGIAO VARCHAR(30),
  MICRORREGIAOGEOGRAFICA NUMERIC(11),
  NOMEMICRORREGIAO VARCHAR(30),
  CODIGOIBGE NUMERIC(50),
  DESCRICAO VARCHAR(30),
  PRIMARY KEY(IDMUNICIPIO),
  FOREIGN KEY(IDUNIDADEFEDERATIVA) REFERENCES UNIDADEFEDERATIVA(IDUNIDADEFEDERATIVA)
);

CREATE TABLE NCM (
  IDNCM NUMERIC(18,0),
  IDUNIDADEFEDERATIVA NUMERIC(18),
  CODIGO NUMERIC(9),
  EX NUMERIC(4),
  TIPO NUMERIC(1),
  DESCRICAO VARCHAR(1000),
  NACIONALFEDERAL NUMERIC(7,2),
  IMPORTADOSFEDERAL NUMERIC(7,2),
  ESTADUAL NUMERIC(7,2),
  MUNICIPAL NUMERIC(7,2),
  VIGENCIAINICIO DATE,
  VIGENCIAFIM DATE,
  CHAVE VARCHAR(100),
  VERSAO VARCHAR(100),
  FONTE VARCHAR(100),
  PRIMARY KEY(IDNCM),
  FOREIGN KEY(IDUNIDADEFEDERATIVA) REFERENCES UNIDADEFEDERATIVA(IDUNIDADEFEDERATIVA)
);

CREATE TABLE FLUXOCAIXA (
  IDFLUXOCAIXA NUMERIC(18,0),
  IDUSUARIO NUMERIC(18,0),
  VALORCAIXA NUMERIC(7,2),
  DATAABERTURACAIXA TIMESTAMP,
  DATAFECHAMENTOCAIXA TIMESTAMP,
  ABERTO NUMERIC(1),
  VALORFECHAMENTOCAIXA NUMERIC(7,2),
  OBSERVACAO TEXT,
  PRIMARY KEY(IDFLUXOCAIXA),
  FOREIGN KEY(IDUSUARIO) REFERENCES USUARIO(IDUSUARIO)
);

CREATE TABLE ENDERECO (
  IDENDERECO NUMERIC(18,0),
  IDMUNICIPIO NUMERIC(18),
  IDUNIDADEFEDERATIVA NUMERIC(18),
  IDPAIS NUMERIC(18),
  LOGRADOURO VARCHAR(150),
  NUMERO NUMERIC(6),
  CEP VARCHAR(8),
  COMPLEMENTO VARCHAR(150),
  BAIRRO VARCHAR(150),
  TELEFONE VARCHAR(11),
  PRIMARY KEY(IDENDERECO),
  FOREIGN KEY(IDMUNICIPIO) REFERENCES MUNICIPIO(IDMUNICIPIO),
  FOREIGN KEY(IDUNIDADEFEDERATIVA) REFERENCES UNIDADEFEDERATIVA(IDUNIDADEFEDERATIVA),
  FOREIGN KEY(IDPAIS) REFERENCES PAIS(IDPAIS)
);

CREATE TABLE SANGRIACAIXA (
  IDSANGRIACAIXA NUMERIC(18,0),
  IDUSUARIOCADASTRO NUMERIC(18,0),
  IDUSUARIO NUMERIC(18,0),
  IDFLUXOCAIXA NUMERIC(18),
  DATASANGRIA TIMESTAMP,
  VALOR NUMERIC(7,2),
  OBSERVACAO TEXT,
  PRIMARY KEY(IDSANGRIACAIXA),
  FOREIGN KEY(IDFLUXOCAIXA) REFERENCES FLUXOCAIXA(IDFLUXOCAIXA),
  FOREIGN KEY(IDUSUARIO) REFERENCES USUARIO(IDUSUARIO),
  FOREIGN KEY(IDUSUARIOCADASTRO) REFERENCES USUARIO(IDUSUARIO)
);

CREATE TABLE PRODUTO (
  IDPRODUTO NUMERIC(18,0),
  IDUNIDADEDEMEDIDA NUMERIC(18),
  IDORIGEMPRODUTO NUMERIC(18),
  IDINTEGRACAOFISCALNFE NUMERIC(18),
  IDINTEGRACAOFISCALNFCE NUMERIC(18),
  IDFORNECEDOR NUMERIC(18),
  IDMARCA NUMERIC(18),
  IDNCM NUMERIC(18),
  IDSUBCATEGORIA NUMERIC(18),
  IDCATEGORIA NUMERIC(18),
  CODIGO VARCHAR(50),
  DESCRICAO VARCHAR(200),
  EXTIPI VARCHAR(2),
  EAN VARCHAR(14),
  CEST VARCHAR(150),
  VALORVENDA NUMERIC(15,2),
  VALORCUSTO NUMERIC(15,2),
  TRIB_MVA NUMERIC(15,2),
  TRIB_REDBCICMS NUMERIC(15,2),
  TRIB_REDBCICMSST NUMERIC(15,2),
  TRIB_ALIQIPI NUMERIC(15,2),
  TRIB_ALIQPIS NUMERIC(15,2),
  TRIB_ALIQCOFINS NUMERIC(15,2),
  TRIB_ALIQICMSDIF NUMERIC(15,2),
  ATIVO NUMERIC(1),
  PRIMARY KEY(IDPRODUTO),
  FOREIGN KEY(IDCATEGORIA) REFERENCES CATEGORIA(IDCATEGORIA),
  FOREIGN KEY(IDSUBCATEGORIA) REFERENCES CATEGORIA(IDCATEGORIA),
  FOREIGN KEY(IDUNIDADEDEMEDIDA) REFERENCES UNIDADEDEMEDIDA(IDUNIDADEDEMEDIDA),
  FOREIGN KEY(IDMARCA) REFERENCES MARCA(IDMARCA),
  FOREIGN KEY(IDFORNECEDOR) REFERENCES FORNECEDOR(IDFORNECEDOR),
  FOREIGN KEY(IDNCM) REFERENCES NCM(IDNCM),
  FOREIGN KEY(IDINTEGRACAOFISCALNFCE) REFERENCES INTEGRACAOFISCAL(IDINTEGRACAOFISCAL),
  FOREIGN KEY(IDINTEGRACAOFISCALNFE) REFERENCES INTEGRACAOFISCAL(IDINTEGRACAOFISCAL),
  FOREIGN KEY(IDORIGEMPRODUTO) REFERENCES ORIGEMPRODUTO(IDORIGEMPRODUTO)
);

CREATE TABLE RETIRADACAIXA (
  IDRETIRADACAIXA NUMERIC(18,0),
  IDFLUXOCAIXA NUMERIC(18),
  VALORRETIRADA NUMERIC(7,2),
  DATARETIRADA TIMESTAMP,
  PRIMARY KEY(IDRETIRADACAIXA),
  FOREIGN KEY(IDFLUXOCAIXA) REFERENCES FLUXOCAIXA(IDFLUXOCAIXA)
);

CREATE TABLE TRANSPORTADORA (
  IDTRANSPORTADORA NUMERIC(18,0),
  IDENDERECO NUMERIC,
  RAZAOSOCIAL VARCHAR(150),
  CNPJ VARCHAR(14),
  CPF VARCHAR(11),
  NOME VARCHAR(150),
  INSCRICAOESTADUAL NUMERIC(14),
  ISENTO NUMERIC(1),
  TIPODOCUMENTO NUMERIC(1),
  EMAIL VARCHAR(150),
  PRIMARY KEY(IDTRANSPORTADORA),
  FOREIGN KEY(IDENDERECO) REFERENCES ENDERECO(IDENDERECO)
);

CREATE TABLE EMITENTE (
  IDEMITENTE NUMERIC(18,0),
  IDENDERECO NUMERIC,
  CNPJ VARCHAR(14),
  RAZAOSOCIAL VARCHAR(150),
  NOMEFANTASIA VARCHAR(150),
  EMAIL VARCHAR(100),
  CRT NUMERIC(1),
  CERTIFICADO BYTEA,
  NOMECERTIFICADO VARCHAR(150),
  CSC VARCHAR(200),
  IDCSC VARCHAR(6),
  INSCRICAOMUNICIPAL NUMERIC(14),
  INSCRICAOESTADUAL NUMERIC(14),
  LOGOMARCA BYTEA,
  NOMELOGOMARCA VARCHAR(150),
  SENHACERTIFICADO VARCHAR(200),
  CNAE NUMERIC(7),
  PRIMARY KEY(IDEMITENTE),
  FOREIGN KEY(IDENDERECO) REFERENCES ENDERECO(IDENDERECO)
);

CREATE TABLE EMAILEMITENTE (
  IDEMAILEMITENTE NUMERIC(18,0),
  IDEMITENTE NUMERIC(18),
  AUTORIZARENVIAREMAIL NUMERIC(1),
  AUTORIZARASSUNTO VARCHAR(150),
  AUTORIZARMENSAGEM TEXT,
  CANCELARENVIAREMAIL NUMERIC(1),
  CANCELARASSUNTO VARCHAR(150),
  CANCELARMENSAGEM TEXT,
  PRIMARY KEY(IDEMAILEMITENTE),
  FOREIGN KEY(IDEMITENTE) REFERENCES EMITENTE(IDEMITENTE)
);

CREATE TABLE CLIENTE (
  IDCLIENTE NUMERIC(18,0),
  IDCONTATO NUMERIC,
  IDENDERECO NUMERIC,
  TIPODOCUMENTO NUMERIC,
  CNPJ VARCHAR(14),
  CPF VARCHAR(11),
  RAZAOSOCIAL VARCHAR(150),
  INSCRICAOESTADUAL NUMERIC(14),
  INSCRICAOMUNICIPAL NUMERIC(14),
  NOME VARCHAR(150),
  NOMEFANTASIA VARCHAR(150),
  ATIVO NUMERIC(1),
  CONSUMIDORFINAL NUMERIC(1),
  ESTRANGEIRO NUMERIC(1),
  DOCESTRANGEIRO VARCHAR(60),
  TIPOCONTRIBUINTE NUMERIC(2),
  PRIMARY KEY(IDCLIENTE),
  FOREIGN KEY(IDENDERECO) REFERENCES ENDERECO(IDENDERECO),
  FOREIGN KEY(IDCONTATO) REFERENCES CONTATO(IDCONTATO)
);

CREATE TABLE VENDA (
  IDVENDA NUMERIC(18,0),
  IDCOMANDAUTILIZADA NUMERIC(18),
  IDCOMANDA NUMERIC(18),
  IDUSUARIO NUMERIC(18,0),
  IDCLIENTE NUMERIC,
  IDFLUXOCAIXA NUMERIC(18),
  QUANTIDADEITENS NUMERIC(18),
  VALORTOTAL NUMERIC(7,2),
  DATACADASTRO TIMESTAMP,
  PRIMARY KEY(IDVENDA),
  FOREIGN KEY(IDFLUXOCAIXA) REFERENCES FLUXOCAIXA(IDFLUXOCAIXA),
  FOREIGN KEY(IDUSUARIO) REFERENCES USUARIO(IDUSUARIO),
  FOREIGN KEY(IDCOMANDA) REFERENCES COMANDA(IDCOMANDA),
  FOREIGN KEY(IDCOMANDAUTILIZADA) REFERENCES COMANDA(IDCOMANDA),
  FOREIGN KEY(IDCLIENTE) REFERENCES CLIENTE(IDCLIENTE)
);

CREATE TABLE NFE (
  IDNFE NUMERIC(18,0),
  IDCLIENTE NUMERIC,
  IDTIPOATENDIMENTO NUMERIC(18),
  IDFINALIDADE NUMERIC(18),
  IDCFOP NUMERIC(18),
  IDUSUARIO NUMERIC(18,0),
  IDTRANSPORTADORA NUMERIC,
  EMISSAO TIMESTAMP,
  SAIDA TIMESTAMP,
  MODELO NUMERIC(2),
  SERIE NUMERIC(10),
  PLACA VARCHAR(8),
  ANTT VARCHAR(100),
  VEICULO VARCHAR(200),
  FRETEPOR NUMERIC(2),
  INFORMACOESCOMPLEMENTARES TEXT,
  INDPAGAMENTO NUMERIC(1),
  PRIMARY KEY(IDNFE),
  FOREIGN KEY(IDTRANSPORTADORA) REFERENCES TRANSPORTADORA(IDTRANSPORTADORA),
  FOREIGN KEY(IDUSUARIO) REFERENCES USUARIO(IDUSUARIO),
  FOREIGN KEY(IDCFOP) REFERENCES CFOP(IDCFOP),
  FOREIGN KEY(IDFINALIDADE) REFERENCES FINALIDADE(IDFINALIDADE),
  FOREIGN KEY(IDTIPOATENDIMENTO) REFERENCES TIPOATENDIMENTO(IDTIPOATENDIMENTO),
  FOREIGN KEY(IDCLIENTE) REFERENCES CLIENTE(IDCLIENTE)
);

CREATE TABLE VOLUMENFE (
  IDVOLUMENFE NUMERIC(18,0),
  IDNFE NUMERIC(18),
  VOLUME VARCHAR(200),
  NUMERO VARCHAR(150),
  PESOLIQUIDO NUMERIC(15,2),
  PESOBRUTO NUMERIC(15,2),
  MARCA VARCHAR(150),
  ESPECIE VARCHAR(150),
  PRIMARY KEY(IDVOLUMENFE),
  FOREIGN KEY(IDNFE) REFERENCES NFE(IDNFE)
);

CREATE TABLE DUPLICATANFE (
  IDDUPLICATANFE NUMERIC(18,0),
  IDNFE NUMERIC(18),
  NUMERODOCUMENTO VARCHAR(250),
  DATAVENCIMENTO DATE,
  VALOR NUMERIC(15,2),
  PRIMARY KEY(IDDUPLICATANFE),
  FOREIGN KEY(IDNFE) REFERENCES NFE(IDNFE)
);

CREATE TABLE DOCUMENTOREFERENCIADONFE (
  IDDOCUMENTOREFERENCIADONFE NUMERIC(18,0),
  IDNFE NUMERIC(18),
  IDUNIDADEFEDERATIVA NUMERIC(18),
  CHAVE VARCHAR(44),
  CODIGODOCUMENTOREFERENCIADO INTEGER,
  PRIMARY KEY(IDDOCUMENTOREFERENCIADONFE),
  FOREIGN KEY(IDUNIDADEFEDERATIVA) REFERENCES UNIDADEFEDERATIVA(IDUNIDADEFEDERATIVA),
  FOREIGN KEY(IDNFE) REFERENCES NFE(IDNFE)
);

CREATE TABLE ITEMVENDAPAGAMENTO (
  IDITEMVENDAPAGAMENTO NUMERIC(18,0),
  IDFORMADEPAGAMENTO NUMERIC(18),
  IDVENDA NUMERIC(18),
  QUANTIDADEPARCELAS NUMERIC(18),
  VALORPAGAMENTO NUMERIC(7,2),
  PRIMARY KEY(IDITEMVENDAPAGAMENTO),
  FOREIGN KEY(IDVENDA) REFERENCES VENDA(IDVENDA),
  FOREIGN KEY(IDFORMADEPAGAMENTO) REFERENCES FORMADEPAGAMENTO(IDFORMADEPAGAMENTO)
);

CREATE TABLE MOVIMENTOFISCAL (
  IDMOVIMENTOFISCAL NUMERIC(18,0),
  IDNFE NUMERIC(18),
  IDVENDA NUMERIC(18),
  SERIE NUMERIC(18),
  XMLENVIO BYTEA,
  XMLRETORNO BYTEA,
  EMITIDA NUMERIC(1),
  CANCELADA NUMERIC(1),
  DATAEMISSAO TIMESTAMP,
  CHAVE VARCHAR(150),
  CSTAT NUMERIC(10),
  XMOTIVO VARCHAR(500),
  DHRECBTO TIMESTAMP,
  AMBIENTE NUMERIC(1),
  CONTINGENCIA NUMERIC(1),
  NUMERO NUMERIC(18,0),
  TIPODOCUMENTO NUMERIC(2),
  PRIMARY KEY(IDMOVIMENTOFISCAL),
  FOREIGN KEY(IDVENDA) REFERENCES VENDA(IDVENDA),
  FOREIGN KEY(IDNFE) REFERENCES NFE(IDNFE)
);

CREATE TABLE ITEMVENDA (
  IDITEMVENDA NUMERIC(18,0),
  IDUSUARIO NUMERIC(18,0),
  IDPRODUTO NUMERIC(18),
  IDVENDA NUMERIC(18),
  QUANTIDADE NUMERIC(18),
  DESCONTOPORCENTAGEM NUMERIC(7,2),
  DESCONTOVALOR NUMERIC(7,2),
  VALORUNITARIOITEM NUMERIC(7,2),
  PRIMARY KEY(IDITEMVENDA),
  FOREIGN KEY(IDVENDA) REFERENCES VENDA(IDVENDA),
  FOREIGN KEY(IDPRODUTO) REFERENCES PRODUTO(IDPRODUTO),
  FOREIGN KEY(IDUSUARIO) REFERENCES USUARIO(IDUSUARIO)
);

CREATE TABLE PRODUTONFE (
  IDPRODUTONFE NUMERIC(18,0),
  IDINTEGRACAOFISCAL NUMERIC(18),
  IDNFE NUMERIC(18),
  IDPRODUTO NUMERIC(18),
  IDUNIDADEDEMEDIDA NUMERIC(18,0),
  IDCFOP NUMERIC(18),
  SEQUENCIA INTEGER,  
  FRETE NUMERIC(15,2),
  OUTRASDESPESAS NUMERIC(15,2),
  DESCONTO NUMERIC(15,2),
  SEGURO NUMERIC(15,2),  
  QUANTIDADE NUMERIC(15,2),
  VALORUNITARIO NUMERIC(15,2),
  
  PRIMARY KEY(IDPRODUTONFE),
  FOREIGN KEY(IDCFOP) REFERENCES CFOP(IDCFOP),
  FOREIGN KEY(IDPRODUTO) REFERENCES PRODUTO(IDPRODUTO),
  FOREIGN KEY(IDNFE) REFERENCES NFE(IDNFE),
  FOREIGN KEY(IDINTEGRACAOFISCAL) REFERENCES INTEGRACAOFISCAL(IDINTEGRACAOFISCAL),
  FOREIGN KEY(IDUNIDADEDEMEDIDA) REFERENCES UNIDADEDEMEDIDA(IDUNIDADEDEMEDIDA)
);  

CREATE TABLE EVENTONFE (
  IDEVENTONFE NUMERIC(18,0),
  IDMOVIMENTOFISCAL NUMERIC(18),
  NSEQEVENTO VARCHAR(200),
  DHEVENTO TIMESTAMP,
  DESCEVENTO VARCHAR,
  NPROT VARCHAR,
  XCORRECAO TEXT,
  XMOTIVO TEXT,
  XML BYTEA,
  CSTAT NUMERIC(10),
  INUTILIZACAO_NNFINI NUMERIC(18,0),
  INUTILIZACAO_NNFFIN NUMERIC(18,0),
  INUTILIZACAO_SERIE NUMERIC(18,0),
  TIPOEVENTO NUMERIC(1),
  PRIMARY KEY(IDEVENTONFE),
  FOREIGN KEY(IDMOVIMENTOFISCAL) REFERENCES MOVIMENTOFISCAL(IDMOVIMENTOFISCAL)
);
	
CREATE TABLE PRODUTONFEICMS(
  IDPRODUTONFEICMS NUMERIC(18,0),
  IDORIGEMPRODUTO NUMERIC(1,0),
  IDCSTICMS NUMERIC(18,0),
  IDUNIDADEFEDERATIVAST NUMERIC(18,0),
  IDPRODUTONFE NUMERIC(18,0),  
  MODBC NUMERIC(1,0),
  PREDBC NUMERIC(5,2),
  VBC NUMERIC(15,2),
  PICMS NUMERIC(5,2),
  VICMS NUMERIC(15,2),
  MODBCST NUMERIC(1,0),
  PMVAST NUMERIC(5,2),
  PREDBCST NUMERIC(5,2),
  VBCST NUMERIC(15,2),
  PICMSST NUMERIC(5,2),
  VICMSST NUMERIC(15,2),
  PCREDSN NUMERIC(5,2),
  VCREDICMSSN NUMERIC(15,2),
  PDIF NUMERIC(5,2),
  VICMSDIF NUMERIC(15,2),
  
  PRIMARY KEY (IDPRODUTONFEICMS),
  FOREIGN KEY (IDORIGEMPRODUTO) REFERENCES ORIGEMPRODUTO(IDORIGEMPRODUTO),
  FOREIGN KEY (IDCSTICMS) REFERENCES CSTICMS(IDCSTICMS),
  FOREIGN KEY (IDUNIDADEFEDERATIVAST) REFERENCES UNIDADEFEDERATIVA(IDUNIDADEFEDERATIVA),
  FOREIGN KEY (IDPRODUTONFE) REFERENCES PRODUTONFE(IDPRODUTONFE)
);

CREATE TABLE PRODUTONFEPIS(
  IDPRODUTONFEPIS NUMERIC(18,0),
  IDPRODUTONFE NUMERIC(18,0),  
  IDCSTPIS NUMERIC(18,0),
  VBC NUMERIC(15,2),
  PPIS NUMERIC(5,2),
  VPIS NUMERIC(15,2),
  
  PRIMARY KEY (IDPRODUTONFEPIS),
  FOREIGN KEY (IDPRODUTONFE) REFERENCES PRODUTONFE(IDPRODUTONFE),
  FOREIGN KEY (IDCSTPIS) REFERENCES CSTPIS(IDCSTPIS)
);

CREATE TABLE PRODUTONFECOFINS(
  IDPRODUTONFECOFINS NUMERIC(18,0),
  IDPRODUTONFE NUMERIC(18,0),  
  IDCSTCOFINS NUMERIC(18,0),
  VBC NUMERIC(15,2),
  PCOFINS NUMERIC(5,2),
  VCOFINS NUMERIC(15,2),
  
  PRIMARY KEY (IDPRODUTONFECOFINS),
  FOREIGN KEY (IDPRODUTONFE) REFERENCES PRODUTONFE(IDPRODUTONFE),
  FOREIGN KEY (IDCSTCOFINS) REFERENCES CSTCOFINS(IDCSTCOFINS)
);

CREATE TABLE PRODUTONFEPARTILHAICMS(
  IDPRODUTONFEPARTILHAICMS NUMERIC(18,0),
  IDPRODUTONFE NUMERIC(18,0),  
  VBCUFDEST NUMERIC(15,2),
  PFCPUFDEST NUMERIC(5,2),
  PICMSUFDEST NUMERIC(5,2),
  PICMSINTER NUMERIC(5,2),
  PICMSINTERPART NUMERIC(5,2),
  VFCPUFDEST NUMERIC(15,2),
  VICMSUFDEST NUMERIC(15,2),
  VICMSUFREMET NUMERIC(15,2),  
  
  PRIMARY KEY (IDPRODUTONFEPARTILHAICMS),
  FOREIGN KEY (IDPRODUTONFE) REFERENCES PRODUTONFE(IDPRODUTONFE)
);

/* ======================================== ALTER TABLE ========================================*/

/* PAULO.FOLETTO EM 30/05/2017 #Alterações da NFe */
ALTER TABLE INTEGRACAOFISCAL ADD COLUMN IPI NUMERIC(1);
ALTER TABLE CLIENTE ALTER COLUMN INSCRICAOESTADUAL TYPE VARCHAR(20);
ALTER TABLE CLIENTE ALTER COLUMN INSCRICAOMUNICIPAL TYPE VARCHAR(20);
ALTER TABLE EMITENTE ALTER COLUMN INSCRICAOESTADUAL TYPE VARCHAR(20);
ALTER TABLE EMITENTE ALTER COLUMN INSCRICAOMUNICIPAL TYPE VARCHAR(20);

/* PAULO.FOLETTO EM 07/06/2017 #Financeiro */
CREATE TABLE BANCO (
  IDBANCO NUMERIC(18,0),
  CODBACEN NUMERIC(4),
  NOME VARCHAR(100),
  SITE VARCHAR(100),
  PRIMARY KEY (IDBANCO)
);

CREATE TABLE CONTABANCARIA (
  IDCONTABANCARIA NUMERIC(18,0),
  IDBANCO NUMERIC(18,0),
  NOME VARCHAR(60),
  AGENCIA VARCHAR(10),
  CONTA VARCHAR(60),
  DIGITO VARCHAR(1),
  ATIVO NUMERIC(1),
  CAIXA NUMERIC(1),
  
  PRIMARY KEY (IDCONTABANCARIA),
  FOREIGN KEY (IDBANCO) REFERENCES BANCO(IDBANCO)
);

/* PAULO.FOLETTO EM 18/08/2017 - #Refatoração para contemplar Juros/Multa. */
CREATE TABLE CONTACOBRANCA (
  IDCONTACOBRANCA NUMERIC(18,0),
  IDCONTABANCARIA NUMERIC(18,0),
  LEIAUTE VARCHAR(30),
  ESPECIEDOC VARCHAR(5),
  ACEITE NUMERIC(1),
  CARTEIRA VARCHAR(5),
  REGISTRO NUMERIC(1),
  ESPECIE VARCHAR(5),
  CEDENTE VARCHAR(20),
  NOSSONUMERO NUMERIC(10),
  ATIVO NUMERIC(1),
  INSTRUCOES TEXT,
  DIASPAGTO NUMERIC(18,0),
  TAXA NUMERIC(15,2),
  LOCALPAGTO VARCHAR(150),
  VALORMULTA NUMERIC(7,2),
  PERCENTUALJUROS NUMERIC(7,2),
  IDFORMADEPAGAMENTO NUMERIC(18,0),
  
  PRIMARY KEY (IDCONTACOBRANCA),
  FOREIGN KEY (IDFORMADEPAGAMENTO) REFERENCES FORMADEPAGAMENTO(IDFORMADEPAGAMENTO),
  FOREIGN KEY (IDCONTABANCARIA) REFERENCES CONTABANCARIA(IDCONTABANCARIA)
);

CREATE TABLE CENTROCUSTO (
  IDCENTROCUSTO NUMERIC(18,0),
  CENTRO VARCHAR(10),
  DESCRICAO VARCHAR(60),
  OBSERVACAO TEXT,
  PRIMARY KEY (IDCENTROCUSTO)
);

CREATE TABLE NATUREZA (
  IDNATUREZA NUMERIC(18,0),
  CONTA VARCHAR(10),
  DESCRICAO VARCHAR(50),
  APLICACAO TEXT, --'descrição de uso',
  TIPO NUMERIC(1,0), --'R - RECEITA / D - DESPESA',
  PRIMARY KEY (IDNATUREZA)
);

CREATE TABLE TIPOTITULO (
  IDTIPOTITULO NUMERIC(18,0),
  DESCRICAO VARCHAR(20),
  SIGLA VARCHAR(4),
  PRIMARY KEY (IDTIPOTITULO)
);

CREATE TABLE STATUSTITULO (
  IDSTATUSTITULO NUMERIC(18,0),
  DESCRICAO VARCHAR(20),
  SIGLA VARCHAR(4),
  TIPO NUMERIC(1), --'P-pagar R-receber'
  PRIMARY KEY (IDSTATUSTITULO)
);

CREATE TABLE HISTORICOFINANCEIRO (
  IDHISTORICOFINANCEIRO NUMERIC(18,0),
  DESCRICAO VARCHAR(50),
  PRIMARY KEY (IDHISTORICOFINANCEIRO)
);

CREATE TABLE CONTARECEBER (
  IDCONTARECEBER NUMERIC(18,0),  
  IDCONTABANCARIA NUMERIC(18,0),
  IDTIPOTITULO NUMERIC(18,0),
  IDCLIENTE NUMERIC(18,0),
  IDFORMADEPAGAMENTO NUMERIC(18,0),
  IDHISTORICOFINANCEIRO NUMERIC(18,0),
  IDSTATUSTITULO NUMERIC(18,0),
  TITULO VARCHAR(10),
  PARCELA NUMERIC(3),
  EMISSAO DATE,
  VENCIMENTO DATE,
  COMPLMHISFIN VARCHAR(100),
  FLUXO DATE,
  VALOR NUMERIC(15,2),
  ORIGEM VARCHAR(10),
  MULTA NUMERIC(15,2),
  JUROS NUMERIC(15,2),
  DESCONTO NUMERIC(15,2),
  SITUACAO NUMERIC(1), --'A-ABERTO/P-PARCIAL/B-BAIXADO/C-CANCELADO',
  VALORTOTAL NUMERIC(15,2),
  SALDO NUMERIC(15,2),
  
  PRIMARY KEY (IDCONTARECEBER),
  FOREIGN KEY (IDCONTABANCARIA) REFERENCES CONTABANCARIA(IDCONTABANCARIA),
  FOREIGN KEY (IDTIPOTITULO) REFERENCES TIPOTITULO(IDTIPOTITULO),
  FOREIGN KEY (IDCLIENTE) REFERENCES CLIENTE(IDCLIENTE),
  FOREIGN KEY (IDFORMADEPAGAMENTO) REFERENCES FORMADEPAGAMENTO(IDFORMADEPAGAMENTO),
  FOREIGN KEY (IDHISTORICOFINANCEIRO) REFERENCES HISTORICOFINANCEIRO(IDHISTORICOFINANCEIRO),
  FOREIGN KEY (IDSTATUSTITULO) REFERENCES STATUSTITULO(IDSTATUSTITULO)
);

CREATE TABLE CONTARECOBRANCA (
  IDCONTARECOBRANCA NUMERIC(18,0),
  IDCONTARECEBER NUMERIC(18,0),
  EMISSAO DATE,
  VENCIMENTO DATE,
  VALOR NUMERIC(15,2),
  NOSSONUMERO NUMERIC(10),
  STATUS NUMERIC(1), --'I - IMPRESSO/C - CANCELADO'
  PRIMARY KEY (IDCONTARECOBRANCA),
  FOREIGN KEY (IDCONTARECEBER) REFERENCES CONTARECEBER(IDCONTARECEBER)
);

/* MARCO POLO EM 05/07/2017 #REFATORACAO CONTARECCOBRANCA */
CREATE TABLE CONTARECCOBRANCA(
    IDCONTARECCOBRANCA NUMERIC(18) NOT NULL,
    IDCONTARECEBER NUMERIC(18),
    EMISSAO DATE,
    VENCIMENTO DATE,
    VALOR NUMERIC(15, 2),
    NOSSONUMERO NUMERIC(10),
    STATUS NUMERIC(1),
    IDCONTACOBRANCA NUMERIC(18,0),
    PRIMARY KEY (IDCONTARECCOBRANCA),
    FOREIGN KEY (IDCONTACOBRANCA) REFERENCES CONTACOBRANCA (IDCONTACOBRANCA),
    FOREIGN KEY (IDCONTARECEBER) REFERENCES CONTARECEBER (IDCONTARECEBER)
);

CREATE TABLE BAIXARECEBIMENTO (
  IDBAIXARECEBIMENTO NUMERIC(18,0),
  IDCONTARECEBER NUMERIC(18,0),
  IDFORMADEPAGAMENTO NUMERIC(18,0),
  IDCONTABANCARIA NUMERIC(18,0),
  IDHISTORICOFINANCEIRO NUMERIC(18,0),
  COMPLMHISFIN VARCHAR(30),
  BAIXA DATE,
  MULTA NUMERIC(15,2),
  JUROS NUMERIC(15,2),
  DESCONTO NUMERIC(15,2),
  VALOR NUMERIC(15,2),
  DATACONCILIACAO DATE,
  
  PRIMARY KEY (IDBAIXARECEBIMENTO),
  FOREIGN KEY (IDCONTARECEBER) REFERENCES CONTARECEBER(IDCONTARECEBER),
  FOREIGN KEY (IDFORMADEPAGAMENTO) REFERENCES FORMADEPAGAMENTO(IDFORMADEPAGAMENTO),
  FOREIGN KEY (IDCONTABANCARIA) REFERENCES CONTABANCARIA(IDCONTABANCARIA),
  FOREIGN KEY (IDHISTORICOFINANCEIRO) REFERENCES HISTORICOFINANCEIRO(IDHISTORICOFINANCEIRO)
);

/* PAULO.FOLETTO EM 27/06/2017 #Continuação Tabelas Financeiro */
CREATE TABLE CONTAPAGAR (
  IDCONTAPAGAR NUMERIC(18),
  IDCONTABANCARIA NUMERIC(18),
  IDTIPOTITULO NUMERIC(18),
  IDFORNECEDOR NUMERIC(18),
  IDFORMADEPAGAMENTO NUMERIC(18),
  IDHISTORICOFINANCEIRO NUMERIC(18),
  IDSTATUSTITULO NUMERIC(18),
  TITULO VARCHAR(10), -- Numero do Documento
  PARCELA NUMERIC(3), -- Numero da Parcela
  EMISSAO DATE,
  VENCIMENTO DATE,
  COMPLMHISFIN VARCHAR(100),
  FLUXO DATE,
  VALOR NUMERIC(15,2),
  ORIGEM VARCHAR(10),
  MULTA NUMERIC(15,2),
  JUROS NUMERIC(15,2),
  DESCONTO NUMERIC(15,2),
  SITUACAO NUMERIC(1), --'A-ABERTO/P-PARCIAL/B-BAIXADO/C-CANCELADO'
  VALORTOTAL NUMERIC(15,2),
  SALDO NUMERIC(15,2),
  
  PRIMARY KEY (IDCONTAPAGAR),
  FOREIGN KEY (IDCONTABANCARIA) REFERENCES CONTABANCARIA(IDCONTABANCARIA),
  FOREIGN KEY (IDTIPOTITULO) REFERENCES TIPOTITULO(IDTIPOTITULO),
  FOREIGN KEY (IDFORNECEDOR) REFERENCES FORNECEDOR(IDFORNECEDOR),
  FOREIGN KEY (IDFORMADEPAGAMENTO) REFERENCES FORMADEPAGAMENTO(IDFORMADEPAGAMENTO),
  FOREIGN KEY (IDHISTORICOFINANCEIRO) REFERENCES HISTORICOFINANCEIRO(IDHISTORICOFINANCEIRO),
  FOREIGN KEY (IDSTATUSTITULO) REFERENCES STATUSTITULO(IDSTATUSTITULO)
);

CREATE TABLE BAIXAPAGAMENTO (
  IDBAIXAPAGAMENTO NUMERIC(18,0),
  IDCONTAPAGAR NUMERIC(18,0),
  IDFORMADEPAGAMENTO NUMERIC(18,0),
  IDCONTABANCARIA NUMERIC(18,0),
  IDHISTORICOFINANCEIRO NUMERIC(18,0),
  COMPLMHISFIN VARCHAR(30),
  BAIXA DATE,
  MULTA NUMERIC(15,2),
  JUROS NUMERIC(15,2),
  DESCONTO NUMERIC(15,2),
  VALOR NUMERIC(15,2),
  DATACONCILIACAO DATE,
  
  PRIMARY KEY (IDBAIXAPAGAMENTO),
  FOREIGN KEY (IDCONTAPAGAR) REFERENCES CONTAPAGAR(IDCONTAPAGAR),
  FOREIGN KEY (IDFORMADEPAGAMENTO) REFERENCES FORMADEPAGAMENTO(IDFORMADEPAGAMENTO),
  FOREIGN KEY (IDCONTABANCARIA) REFERENCES CONTABANCARIA(IDCONTABANCARIA),
  FOREIGN KEY (IDHISTORICOFINANCEIRO) REFERENCES HISTORICOFINANCEIRO(IDHISTORICOFINANCEIRO)
);

CREATE TABLE TALONARIO (
  IDTALONARIO NUMERIC(18,0),
  IDCONTABANCARIA NUMERIC(18,0),
  NUMERO VARCHAR(20),
  EMISSAO DATE,
  INICIO NUMERIC(11),
  FIM NUMERIC(11),
  ATIVO NUMERIC(1),
  OBS BYTEA,
  
  PRIMARY KEY (IDTALONARIO),
  FOREIGN KEY (IDCONTABANCARIA) REFERENCES CONTABANCARIA (IDCONTABANCARIA) 
);

/* MARCO POLO EM 06/07/2017 #REFATORAR CHEQUE EMITIDO */
CREATE TABLE CHEQUECONTAPAGAR (
  IDCHEQUECONTAPAGAR NUMERIC(18,0),
  IDTALONARIO NUMERIC(18,0),
  IDBAIXAPAGAMENTO NUMERIC(18,0),
  NUMERO NUMERIC(11,0),
  VALOR NUMERIC(15,2),
  EMISSAO DATE,
  VENCIMENTO DATE,
  CRUZADO NUMERIC(1,0),
  COMPENSADO NUMERIC(1,0),
  DATACOMPENSACAO DATE,
  DEVOLVIDO NUMERIC(1,0),
  DATADEVOLUCAO DATE,
  PRIMARY KEY (IDCHEQUECONTAPAGAR),
  FOREIGN KEY (IDBAIXAPAGAMENTO) REFERENCES BAIXAPAGAMENTO (IDBAIXAPAGAMENTO),
  FOREIGN KEY (IDTALONARIO) REFERENCES TALONARIO (IDTALONARIO)
);

/* MARCO POLO EM 06/07/2017 #REFATORAR CHEQUE RECEBIDO */
CREATE TABLE CHEQUECONTARECEBER (
  IDCHEQUECONTARECEBER NUMERIC(18,0),
  IDBAIXARECEBIMENTO NUMERIC(18,0),
  NUMERO NUMERIC(11,0),
  VALOR NUMERIC(15,2),
  EMISSAO DATE,
  VENCIMENTO DATE,
  CRUZADO NUMERIC(1,0),
  COMPENSADO NUMERIC(1),
  DATACOMPENSACAO DATE,
  DEVOLVIDO NUMERIC(1,0),
  DATADEVOLUCAO DATE,
  REPASSE NUMERIC(1,0),
  DATAREPASSE DATE,
  OBSREPASSE BYTEA,
  PRIMARY KEY (IDCHEQUECONTARECEBER),
  FOREIGN KEY (IDBAIXARECEBIMENTO) REFERENCES BAIXARECEBIMENTO (IDBAIXARECEBIMENTO)
);

/* PAULO.FOLETTO EM 31/07/2017 #Classificações de ContaReceber/ContaPagar */
CREATE TABLE CLASSIFICACAOCONTARECEBER(
   IDCLASSIFICACAOCONTARECEBER NUMERIC(18,0),
   IDNATUREZA NUMERIC(18,0),
   IDCENTROCUSTO NUMERIC(18,0),
   IDCONTARECEBER NUMERIC(18,0),
   VALOR NUMERIC(7,2),

   PRIMARY KEY (IDCLASSIFICACAOCONTARECEBER),
   FOREIGN KEY (IDNATUREZA) REFERENCES NATUREZA(IDNATUREZA),
   FOREIGN KEY (IDCENTROCUSTO) REFERENCES CENTROCUSTO(IDCENTROCUSTO),
   FOREIGN KEY (IDCONTARECEBER) REFERENCES CONTARECEBER(IDCONTARECEBER)
);

CREATE TABLE CLASSIFICACAOCONTAPAGAR(
   IDCLASSIFICACAOCONTAPAGAR NUMERIC(18,0),
   IDNATUREZA NUMERIC(18,0),
   IDCENTROCUSTO NUMERIC(18,0),
   IDCONTAPAGAR NUMERIC(18,0),
   VALOR NUMERIC(7,2),

   PRIMARY KEY (IDCLASSIFICACAOCONTAPAGAR),
   FOREIGN KEY (IDNATUREZA) REFERENCES NATUREZA(IDNATUREZA),
   FOREIGN KEY (IDCENTROCUSTO) REFERENCES CENTROCUSTO(IDCENTROCUSTO),
   FOREIGN KEY (IDCONTAPAGAR) REFERENCES CONTAPAGAR(IDCONTAPAGAR)
);

/* PAULO.FOLETTO EM 01/08/2017 #Centro/Natureza Superior */
ALTER TABLE CENTROCUSTO ADD COLUMN IDCENTROCUSTOSUPERIOR NUMERIC(18,0);
ALTER TABLE CENTROCUSTO ADD FOREIGN KEY (IDCENTROCUSTOSUPERIOR) REFERENCES CENTROCUSTO (IDCENTROCUSTO);

ALTER TABLE NATUREZA ADD COLUMN IDNATUREZASUPERIOR NUMERIC(18,0);
ALTER TABLE NATUREZA ADD FOREIGN KEY (IDNATUREZASUPERIOR) REFERENCES NATUREZA (IDNATUREZA);
ALTER TABLE ITEMVENDAPAGAMENTO ADD COLUMN PRIMEIROVENCIMENTO DATE;

/* PAULO.FOLETTO EM #15/08/2017 #Forma de Pagamento para geração de duplicatas */
ALTER TABLE FORMADEPAGAMENTO ADD COLUMN ATIVO NUMERIC(1);
ALTER TABLE FORMADEPAGAMENTO ADD COLUMN IDENTIFICACAO VARCHAR(200);

/* PAULO.FOLETTO EM 20/08/2017 #Coluna Dígito Agencia em Conta Bancária */
ALTER TABLE CONTABANCARIA ADD COLUMN DIGITOAGENCIA NUMERIC(1);

/* PAULO.FOLETTO EM 20/08/2017 #Coluna VariacaoCarteira Banco BB */
ALTER TABLE CONTACOBRANCA ADD COLUMN VARIACAOCARTEIRA VARCHAR(5);

/* PAULO.FOLETTO EM 20/08/2017 #Colunas Novas em ContaRecCobranca */
ALTER TABLE CONTARECCOBRANCA ALTER COLUMN NOSSONUMERO TYPE VARCHAR(200);
ALTER TABLE CONTARECCOBRANCA ADD COLUMN NUMERODOCUMENTO VARCHAR(100);
ALTER TABLE CONTARECCOBRANCA ADD COLUMN NUMEROCONTROLEPARTICIPANTE VARCHAR(100);

/* PAULO.FOLETTO EM 22/08/2017 #Coluna Operação Banco Caixa */
ALTER TABLE CONTABANCARIA ADD COLUMN OPERACAO VARCHAR(3);

/* PAULO.FOLETTO EM 22/08/2017 #Coluna CNAB em Conta Cobranca */
ALTER TABLE CONTACOBRANCA ADD COLUMN CNAB NUMERIC(1);

/* PAULO.FOLETTO EM 25/08/2017 #Coluna Numero Remessa em Conta Cobranca */
ALTER TABLE CONTACOBRANCA ADD COLUMN NUMEROREMESSA NUMERIC(10,0);

/* PAULO.FOLETTO EM 25/08/2017 #Coluna Vencimento em ContaRecCobranca */
ALTER TABLE CONTARECCOBRANCA ADD COLUMN CANCELAMENTO DATE;

/* PAULO.FOLETTO EM 28/08/2017 #Coluna IDcontaReceberRenegociacao */
ALTER TABLE CONTARECEBER ADD COLUMN IDCONTARECEBERRENEGOCIACAO NUMERIC(18,0);
ALTER TABLE CONTARECEBER ADD FOREIGN KEY (IDCONTARECEBERRENEGOCIACAO) REFERENCES CONTARECEBER (IDCONTARECEBER);

/* PAULO.FOLETTO EM 31/08/2017 #Coluna IDFormaDePagamento na NFe */
ALTER TABLE NFE ADD COLUMN IDFORMADEPAGAMENTO NUMERIC(18,0);
ALTER TABLE NFE ADD FOREIGN KEY (IDFORMADEPAGAMENTO) REFERENCES FORMADEPAGAMENTO (IDFORMADEPAGAMENTO);

/* PAULO.FOLETTO EM 31/08/2017 #Coluna IDMovimentoFiscal em ContaReceber */
ALTER TABLE CONTARECEBER ADD COLUMN IDMOVIMENTOFISCAL NUMERIC(18,0);
ALTER TABLE CONTARECEBER ADD FOREIGN KEY (IDMOVIMENTOFISCAL) REFERENCES MOVIMENTOFISCAL (IDMOVIMENTOFISCAL);

/* PAULO.FOLETTO EM 20/09/2017 #Remodelação da comanda dentro do PDV */
ALTER TABLE COMANDA DROP COLUMN STATUS;
ALTER TABLE COMANDA DROP COLUMN CPF;

/* PAULO.FOLETTO EM 10/10/2017 #Tabelas do MDFe */
CREATE TABLE SEGURADORA (
  IDSEGURADORA NUMERIC(18,0),
  DESCRICAO VARCHAR(200),
  CNPJ VARCHAR(14),
  ATIVO NUMERIC(1),
  
  PRIMARY KEY (IDSEGURADORA)
);

CREATE TABLE PROPRIETARIOVEICULOMDFE (
  IDPROPRIETARIOVEICULOMDFE NUMERIC(18,0),
  CNPJ VARCHAR(14),
  CPF VARCHAR(11),
  RNTRC VARCHAR(8),
  NOME VARCHAR(60),
  INSCRICAOESTADUAL NUMERIC(14),
  IDUNIDADEFEDERATIVA NUMERIC(18,0),
  TIPOPROPRIETARIO NUMERIC(1),
  CODIGOAGENCIAPORTO NUMERIC(16),
  
  PRIMARY KEY (IDPROPRIETARIOVEICULOMDFE),
  FOREIGN KEY (IDUNIDADEFEDERATIVA) REFERENCES UNIDADEFEDERATIVA(IDUNIDADEFEDERATIVA)
);

CREATE TABLE MDFE (
  IDMDFE NUMERIC(18,0),
  TIPOAMBIENTE NUMERIC(1),
  TIPOEMITENTE NUMERIC(1),
  TIPOTRANSPORTADOR NUMERIC(1),
  MODELO NUMERIC(2),
  SERIE NUMERIC(3),
  NMDF NUMERIC(9),
  CMDF NUMERIC(8),
  MODALIDADETRANSPORTE NUMERIC(1),
  EMISSAO TIMESTAMP,
  TIPOEMISSAO NUMERIC(1),
  IDEMITENTE NUMERIC(18,0),
  INFORMACOESADICIONAIS VARCHAR(2000),
  INFORMACOESCOMPLEMENTARES VARCHAR(5000),
  DATACADASTRO TIMESTAMP,
  IDUNIDADEFEDERATIVADESCARREGAMENTO NUMERIC(18,0),  
  
  PRIMARY KEY (IDMDFE),
  FOREIGN KEY (IDEMITENTE) REFERENCES EMITENTE(IDEMITENTE),
  FOREIGN KEY (IDUNIDADEFEDERATIVADESCARREGAMENTO) REFERENCES UNIDADEFEDERATIVA(IDUNIDADEFEDERATIVA)
);

CREATE TABLE VEICULO (
  IDVEICULO NUMERIC(18,0),
  PLACA VARCHAR(7),
  CERTIFICADOPROPRIEDADE VARCHAR(200),
  MODELO VARCHAR(60),
  RENAVAM VARCHAR(11),
  TARAEMKG NUMERIC(7,2),
  CAPACIDADEEMKG NUMERIC(7,2),
  CAPACIDADEEMM3 NUMERIC(7,2),
  ANOFABRICACAO NUMERIC(4),
  ANOMODELO NUMERIC(4),
  REGISTROANTT VARCHAR(100),
  TIPOPROPRIEDADE NUMERIC(1),
  TIPOVEICULO NUMERIC(1),
  TIPORODADO NUMERIC(1),
  TIPOCARROCERIA NUMERIC(1),
  IDMARCA NUMERIC(18,0),
  ATIVO NUMERIC(1),
  
  PRIMARY KEY (IDVEICULO),
  FOREIGN KEY (IDMARCA) REFERENCES MARCA(IDMARCA)
);

CREATE TABLE CONDUTOR (
  IDCONDUTOR NUMERIC(18,0),
  CPF VARCHAR(11),
  NOME VARCHAR(60),
  ATIVO NUMERIC(1),
  IDUNIDADEFEDERATIVA NUMERIC(18,0),

  PRIMARY KEY (IDCONDUTOR),
  FOREIGN KEY (IDUNIDADEFEDERATIVA) REFERENCES UNIDADEFEDERATIVA(IDUNIDADEFEDERATIVA)
);

CREATE TABLE PERCURSOMDFE (
  IDPERCURSOMDFE NUMERIC(18,0),
  IDMDFE NUMERIC(18,0),
  IDUNIDADEFEDERATIVAPERCURSO NUMERIC(18,0),
  INICIOVIAGEM TIMESTAMP,
  
  PRIMARY KEY (IDPERCURSOMDFE),
  FOREIGN KEY (IDMDFE) REFERENCES MDFE(IDMDFE),
  FOREIGN KEY (IDUNIDADEFEDERATIVAPERCURSO) REFERENCES UNIDADEFEDERATIVA(IDUNIDADEFEDERATIVA)  
);

CREATE TABLE RESPONSAVELSEGUROCARGAMDFE (
  IDRESPONSAVELSEGUROCARGAMDFE NUMERIC(18,0),
  IDMDFE NUMERIC(18,0),
  RESPONSAVELSEGURO NUMERIC(1),
  CNPJ VARCHAR(14),
  CPF VARCHAR(11),
  
  PRIMARY KEY (IDRESPONSAVELSEGUROCARGAMDFE),
  FOREIGN KEY (IDMDFE) REFERENCES MDFE(IDMDFE)
);

CREATE TABLE VALEPEDAGIOMDFE (
  IDVALEPEDAGIOMDFE NUMERIC(18,0),
  IDMDFE NUMERIC(18,0),
  CNPJFORNECEDORA VARCHAR(14),
  CNPJPAGAMENTO VARCHAR(14),
  CPFPAGAMENTO VARCHAR(11),
  NUMEROCOMPRA VARCHAR(20),
  VALOR NUMERIC(13,2),
  
  PRIMARY KEY (IDVALEPEDAGIOMDFE),
  FOREIGN KEY (IDMDFE) REFERENCES MDFE(IDMDFE)
);

CREATE TABLE CONTRATANTEMDFE (
  IDCONTRATANTEMDFE NUMERIC(18,0),
  IDMDFE NUMERIC(18,0),
  CPF VARCHAR(11),
  CNPJ VARCHAR(14),
  
  PRIMARY KEY (IDCONTRATANTEMDFE),
  FOREIGN KEY (IDMDFE) REFERENCES MDFE(IDMDFE)
);

CREATE TABLE CIOTMDFE (
  IDCIOTMDFE NUMERIC(18,0),
  IDMDFE NUMERIC(18,0),
  CODIGO NUMERIC(12),
  CPF VARCHAR(11),
  CNPJ VARCHAR(14),
  
  PRIMARY KEY (IDCIOTMDFE),
  FOREIGN KEY (IDMDFE) REFERENCES MDFE(IDMDFE)
);

CREATE TABLE CARREGAMENTOMDFE (
  IDCARREGAMENTOMDFE NUMERIC(18,0),
  IDMDFE NUMERIC(18,0),
  IDUNIDADEFEDERATIVACARREGAMENTO NUMERIC(18,0),
  IDMUNICIPIOCARREGAMENTO NUMERIC(18,0),
  
  PRIMARY KEY (IDCARREGAMENTOMDFE),
  FOREIGN KEY (IDMDFE) REFERENCES MDFE(IDMDFE),
  FOREIGN KEY (IDUNIDADEFEDERATIVACARREGAMENTO) REFERENCES UNIDADEFEDERATIVA(IDUNIDADEFEDERATIVA),
  FOREIGN KEY (IDMUNICIPIOCARREGAMENTO) REFERENCES MUNICIPIO(IDMUNICIPIO)
);

CREATE TABLE DOCUMENTOFISCALMDFE (
  IDDOCUMENTOFISCALMDFE NUMERIC(18,0),
  IDMDFE NUMERIC(18,0),
  IDMUNICIPIODESCARGA NUMERIC(18,0),
  
  PRIMARY KEY (IDDOCUMENTOFISCALMDFE),
  FOREIGN KEY (IDMDFE) REFERENCES MDFE(IDMDFE),
  FOREIGN KEY (IDMUNICIPIODESCARGA) REFERENCES MUNICIPIO(IDMUNICIPIO)
);

CREATE TABLE LACRERODOVIARIOMDFE (
  IDLACRERODOVIARIOMDFE NUMERIC(18,0),
  IDMDFE NUMERIC(18,0),
  NUMERO VARCHAR(20),
  
  PRIMARY KEY (IDLACRERODOVIARIOMDFE),
  FOREIGN KEY (IDMDFE) REFERENCES MDFE(IDMDFE)
);

CREATE TABLE SEGURADORAMDFE (
  IDSEGURADORAMDFE NUMERIC(18,0),
  IDSEGURADORA NUMERIC(18,0),
  IDMDFE NUMERIC(18,0),
  NUMEROAPOLICE VARCHAR(20),
  NUMEROAVERBACAO VARCHAR(40),
  
  PRIMARY KEY (IDSEGURADORAMDFE),
  FOREIGN KEY (IDMDFE) REFERENCES MDFE(IDMDFE),
  FOREIGN KEY (IDSEGURADORA) REFERENCES SEGURADORA(IDSEGURADORA)
);

CREATE TABLE VEICULOTRACAOMDFE (
  IDVEICULOTRACAOMDFE NUMERIC(18,0),
  IDPROPRIETARIOVEICULOMDFE NUMERIC(18,0),
  IDCONDUTOR NUMERIC(18,0),
  IDVEICULO NUMERIC(18,0),
  IDMDFE NUMERIC(18,0),
  
  PRIMARY KEY (IDVEICULOTRACAOMDFE),
  FOREIGN KEY (IDMDFE) REFERENCES MDFE(IDMDFE),
  FOREIGN KEY (IDPROPRIETARIOVEICULOMDFE) REFERENCES PROPRIETARIOVEICULOMDFE(IDPROPRIETARIOVEICULOMDFE),
  FOREIGN KEY (IDVEICULO) REFERENCES VEICULO(IDVEICULO),
  FOREIGN KEY (IDCONDUTOR) REFERENCES CONDUTOR(IDCONDUTOR)
);

CREATE TABLE NFEREFERENCIADAMDFE (
  IDNFEREFERENCIADAMDFE NUMERIC(18,0),
  IDDOCUMENTOFISCALMDFE NUMERIC(18,0),
  CHAVENFE VARCHAR(44),
  
  PRIMARY KEY(IDNFEREFERENCIADAMDFE),
  FOREIGN KEY(IDDOCUMENTOFISCALMDFE) REFERENCES DOCUMENTOFISCALMDFE(IDDOCUMENTOFISCALMDFE)
);

ALTER TABLE VEICULO ADD COLUMN VEICULOEMUSOMDFE NUMERIC(1);
ALTER TABLE VEICULO DROP COLUMN REGISTROANTT;
ALTER TABLE VEICULO ADD COLUMN IDUNIDADEFEDERATIVA NUMERIC(18,0);
ALTER TABLE VEICULO ADD FOREIGN KEY (IDUNIDADEFEDERATIVA) REFERENCES UNIDADEFEDERATIVA (IDUNIDADEFEDERATIVA);

CREATE TABLE MOVIMENTOFISCALMDFE (
   IDMOVIMENTOFISCALMDFE NUMERIC(18,0),
   IDMDFE NUMERIC(18,0),
   SERIE NUMERIC(18,0),
   XMLENVIO BYTEA,
   XMLRETORNO BYTEA,
   EMITIDA NUMERIC(1,0),
   CANCELADA NUMERIC(1,0),
   DATAEMISSAO TIMESTAMP,
   CHAVE VARCHAR(44),
   CSTAT NUMERIC(10,0),
   MOTIVO VARCHAR(500),
   RECEBIMENTO TIMESTAMP,
   AMBIENTE NUMERIC(1),
   NUMERO NUMERIC(18,0),
   TIPODOCUMENTO NUMERIC(18,0),
   ENCERRADA NUMERIC(1),

   PRIMARY KEY (IDMOVIMENTOFISCALMDFE),
   FOREIGN KEY (IDMDFE) REFERENCES MDFE (IDMDFE)
);

ALTER TABLE MDFE ADD COLUMN CODIGOUNPESOCARGA NUMERIC(1);
ALTER TABLE VEICULO DROP COLUMN CERTIFICADOPROPRIEDADE;

CREATE TABLE EVENTOMDFE (
   IDEVENTOMDFE NUMERIC(18,0),
   IDMOVIMENTOFISCALMDFE NUMERIC(18,0),
   NSEQEVENTO NUMERIC(18,0),
   DHEVENTO TIMESTAMP,
   DESCEVENTO VARCHAR(200),
   NPROT VARCHAR(200),
   XMOTIVO VARCHAR(200),
   CSTAT NUMERIC(10,0),
   TIPOEVENTO NUMERIC(1),

   PRIMARY KEY (IDEVENTOMDFE),
   FOREIGN KEY (IDMOVIMENTOFISCALMDFE) REFERENCES MOVIMENTOFISCALMDFE (IDMOVIMENTOFISCALMDFE)
);

ALTER TABLE MDFE ADD COLUMN PESOBRUTOTOTAL NUMERIC(11,4);

/* PAULO.FOLETTO EM 21/10/2017 #Adicionado Averbação da Seguradora e manutenção nas tabelas de seguradora */
CREATE TABLE AVERBACAOSEGURADORAMDFE(
   IDAVERBACAOSEGURADORAMDFE NUMERIC(18,0),
   IDSEGURADORAMDFE NUMERIC(18,0),
   NUMEROAVERBACAO VARCHAR(40),

   PRIMARY KEY (IDAVERBACAOSEGURADORAMDFE),
   FOREIGN KEY (IDSEGURADORAMDFE) REFERENCES SEGURADORAMDFE (IDSEGURADORAMDFE)
);

ALTER TABLE RESPONSAVELSEGUROCARGAMDFE DROP COLUMN IDMDFE;
ALTER TABLE SEGURADORAMDFE ADD COLUMN IDRESPONSAVELSEGUROCARGAMDFE NUMERIC(18,0);
ALTER TABLE SEGURADORAMDFE ADD FOREIGN KEY (IDRESPONSAVELSEGUROCARGAMDFE) REFERENCES RESPONSAVELSEGUROCARGAMDFE (IDRESPONSAVELSEGUROCARGAMDFE);
ALTER TABLE SEGURADORAMDFE DROP COLUMN NUMEROAVERBACAO;

/* PAULO.FOLETTO EM 25/10/2017 #TABELAS DE SUPRIMENTOS [COMEÇO DO ESTOQUE] */
CREATE TABLE MOTIVOCANCELAMENTO (
   IDMOTIVOCANCELAMENTO NUMERIC(18,0),
   NOME VARCHAR(150),
   TIPO NUMERIC(1), --COMPRA, VENDA
   
   PRIMARY KEY (IDMOTIVOCANCELAMENTO)
);

CREATE TABLE CONTATOCLIENTEFORNECEDOR (
  IDCONTATOCLIENTEFORNECEDOR NUMERIC(18,0),
  IDFORNECEDOR NUMERIC(18,0),
  IDCLIENTE NUMERIC(18,0),  
  NOME VARCHAR(30),
  CARGO VARCHAR(20),
  EMAIL VARCHAR(100),
  TELEFONE1 VARCHAR(20),
  TELEFONE2 VARCHAR(20),
  SEXO NUMERIC(1),
  DATANASCIMENTO DATE,
  
  PRIMARY KEY (IDCONTATOCLIENTEFORNECEDOR),
  FOREIGN KEY (IDCLIENTE) REFERENCES CLIENTE (IDCLIENTE),
  FOREIGN KEY (IDFORNECEDOR) REFERENCES FORNECEDOR (IDFORNECEDOR)
);

CREATE TABLE HISTORICOCLIENTEFORNECEDOR (
   IDHISTORICOCLIENTEFORNECEDOR NUMERIC(18,0),
   IDFORNECEDOR NUMERIC(18,0),
   IDCLIENTE NUMERIC(18,0),
   DATAHISTORICO TIMESTAMP,
   ASSUNTO VARCHAR(50),
   OBSERVACAO TEXT,
   
   PRIMARY KEY (IDHISTORICOCLIENTEFORNECEDOR),
   FOREIGN KEY (IDCLIENTE) REFERENCES CLIENTE (IDCLIENTE),
   FOREIGN KEY (IDFORNECEDOR) REFERENCES FORNECEDOR (IDFORNECEDOR)
);

CREATE TABLE ALMOXARIFADO (
   IDALMOXARIFADO NUMERIC(18,0),
   DESCRICAO VARCHAR(30),
   TIPO NUMERIC(1), -- ESTOQUE, PRODUCAO, QUARENTENA
   
   PRIMARY KEY (IDALMOXARIFADO)
);

CREATE TABLE CONVERSAOUNIDADEDEMEDIDA (
   IDCONVERSAOUNIDADEDEMEDIDA NUMERIC(18,0),
   IDPRODUTO NUMERIC(18,0),
   IDUNIDADEDEMEDIDAENTRADA NUMERIC(18,0),
   IDUNIDADEDEMEDIDASAIDA NUMERIC(18,0),
   FATOR NUMERIC(15,4),
   
   PRIMARY KEY (IDCONVERSAOUNIDADEDEMEDIDA),
   FOREIGN KEY (IDPRODUTO) REFERENCES PRODUTO (IDPRODUTO),
   FOREIGN KEY (IDUNIDADEDEMEDIDAENTRADA) REFERENCES UNIDADEDEMEDIDA (IDUNIDADEDEMEDIDA),
   FOREIGN KEY (IDUNIDADEDEMEDIDASAIDA) REFERENCES UNIDADEDEMEDIDA (IDUNIDADEDEMEDIDA)
);

CREATE TABLE SALDOESTOQUEINICIAL (
   IDSALDOESTOQUEINICIAL NUMERIC(18,0),
   IDALMOXARIFADO NUMERIC(18,0),
   IDPRODUTO NUMERIC(18,0),
   DATACADASTRO DATE,
   QUANTIDADE NUMERIC(7,2),
   VALOR NUMERIC(7,2),
   
   PRIMARY KEY (IDSALDOESTOQUEINICIAL),
   FOREIGN KEY (IDPRODUTO) REFERENCES PRODUTO (IDPRODUTO),
   FOREIGN KEY (IDALMOXARIFADO) REFERENCES ALMOXARIFADO (IDALMOXARIFADO)
   
   --MOMENTO DA IMPLANTACAO
   --FAZER UMA MOVIMENTACAO DE ESTOQUE NOVA
   --É DIFERENTE DE INVENTÁRIO
);

CREATE TABLE REQUISITANTE (
   IDREQUISITANTE NUMERIC(18,0),
   IDCENTROCUSTO NUMERIC(18,0),
   NOME VARCHAR(150),
   
   PRIMARY KEY (IDREQUISITANTE),
   FOREIGN KEY (IDCENTROCUSTO) REFERENCES CENTROCUSTO (IDCENTROCUSTO)
   --REQUISITANTE DE MATÉRIA PRIMA
);

/* PAULO.FOLETTO EM 28/10/2017 #Alteração dos Perfil de Acesso */
ALTER TABLE ITEMMENU ADD COLUMN IDITEMMENUSUPERIOR NUMERIC(18,0);
ALTER TABLE ITEMMENU ADD FOREIGN KEY (IDITEMMENUSUPERIOR) REFERENCES ITEMMENU (IDITEMMENU);

/* PAULO.FOLETTO EM 02/11/2017 #Criação da tabela DuplicataNFCe e remoção da tabela ItemVendaPagamento */
DROP TABLE ITEMVENDAPAGAMENTO;
CREATE TABLE DUPLICATANFCE (
   IDDUPLICATANFCE NUMERIC(18,0),
   IDFORMADEPAGAMENTO NUMERIC(18,0),
   IDVENDA NUMERIC(18,0),
   DATAVENCIMENTO DATE,
   VALOR NUMERIC(15,2),  

   PRIMARY KEY (IDDUPLICATANFCE),
   FOREIGN KEY (IDVENDA) REFERENCES VENDA (IDVENDA),
   FOREIGN KEY (IDFORMADEPAGAMENTO) REFERENCES FORMADEPAGAMENTO (IDFORMADEPAGAMENTO)
);

/* PAULO.FOLETTO EM 18/11/2017 #Movimentação Bancária */
CREATE TABLE MOVIMENTOBANCARIO (
  IDMOVIMENTOBANCARIO NUMERIC(18,0),
  IDCONTABANCARIA NUMERIC(18,0),
  IDNATUREZA NUMERIC(18,0),
  DATAMOVIMENTO TIMESTAMP,
  VALOR NUMERIC(15,2),
  DOCUMENTO VARCHAR(10), --Quando for Baixa de Titulo, Pagar/Receber => Campo Titulo
  SEQUENCIA NUMERIC(5), --Campo Parcela do Titulo.
  HISTORICO VARCHAR(50), --Histórico do Titulo
  TIPO NUMERIC(1), --Credito ou Débito.   Credito = Receber, Débito = Pagar
  CONCILIACAO TIMESTAMP,

  PRIMARY KEY (IDMOVIMENTOBANCARIO),
  FOREIGN KEY (IDCONTABANCARIA) REFERENCES CONTABANCARIA (IDCONTABANCARIA),
  FOREIGN KEY (IDNATUREZA) REFERENCES NATUREZA (IDNATUREZA)
);

/* PAULO.FOLETTO EM 23/11/2017 #Tabelas do Pedido de Compra/Estoque */
CREATE TABLE PEDIDOCOMPRA (
  IDPEDIDOCOMPRA NUMERIC(18,0),
  IDFORNECEDOR NUMERIC(18,0),
  IDFORMADEPAGAMENTO NUMERIC(18,0),
  IDTRANSPORTADORA NUMERIC(18,0),
  IDUSUARIOCADASTRO NUMERIC(18,0),
  
  DATAEMISSAO TIMESTAMP,
  DATAENTREGA TIMESTAMP,
  TIPOFRETE NUMERIC(1),
  OBSERVACAO TEXT,
  DATAALTERACAO TIMESTAMP,
  DATACANCELAMENTO TIMESTAMP,
  TOTAL NUMERIC(15,2),
  STATUS NUMERIC(1), --0-ABERTO / 1-PARCIAL / 2-BAIXADO
  
  PRIMARY KEY (IDPEDIDOCOMPRA),
  FOREIGN KEY (IDFORNECEDOR) REFERENCES FORNECEDOR (IDFORNECEDOR),
  FOREIGN KEY (IDFORMADEPAGAMENTO) REFERENCES FORMADEPAGAMENTO (IDFORMADEPAGAMENTO),
  FOREIGN KEY (IDTRANSPORTADORA) REFERENCES TRANSPORTADORA (IDTRANSPORTADORA),
  FOREIGN KEY (IDUSUARIOCADASTRO) REFERENCES USUARIO (IDUSUARIO)
);

CREATE TABLE ITEMPEDIDOCOMPRA (
  IDITEMPEDIDOCOMPRA NUMERIC(18,0),
  IDPEDIDOCOMPRA NUMERIC(18,0),
  IDPRODUTO NUMERIC(18,0),
  QUANTIDADE NUMERIC(15,4),
  VALORUNITARIO NUMERIC(15,2),
  DESCONTO NUMERIC(15,2),
  TOTAL NUMERIC(15,2),
  
  PRIMARY KEY (IDITEMPEDIDOCOMPRA),
  FOREIGN KEY (IDPEDIDOCOMPRA) REFERENCES PEDIDOCOMPRA (IDPEDIDOCOMPRA),
  FOREIGN KEY (IDPRODUTO) REFERENCES PRODUTO (IDPRODUTO)
);

CREATE TABLE NFEENTRADA (
  IDNFEENTRADA NUMERIC(18,0),
  IDFORNECEDOR NUMERIC(18,0),
  IDTRANSPORTADORA NUMERIC(18,0),
  IDPEDIDOCOMPRA NUMERIC(18,0),
  
  CUF VARCHAR(2),
  CNF INTEGER,
  NATOPE VARCHAR(60),
  INDPAG INT,
  MODDOC INT,
  SERIE INT,
  NNF INT,
  DHEMI TIMESTAMP,
  DHSAIENT TIMESTAMP,
  TPNF INT,
  IDDEST INT,
  CMUNFG VARCHAR(7),
  TPIMP INT,
  TPEMIS INT,
  CDV INT, 
  TPAMB INT,
  FINNFE INT,
  INDFINAL INT,
  INDPRES INT,
  PROCEMI INT, 
  VERPROC VARCHAR(20),
  DHCONT TIMESTAMP,
  XJUST VARCHAR(255),
  MODFRETE INT,
  PLACA VARCHAR(8),
  UF VARCHAR(2),
  QVOL NUMERIC(12,3),
  ESP VARCHAR(60),
  MARCA VARCHAR(60),
  NVOL VARCHAR(60),
  PESOL NUMERIC(12,3),
  PESOB NUMERIC(12,3),
  INFADFISCO TEXT,
  INFCPL TEXT,
  XCAMPO VARCHAR(20),
  XTEXTO VARCHAR(60), 
  VBC NUMERIC(15,2),
  VICMS NUMERIC(15,2),
  VBCST NUMERIC(15,2), 
  VST NUMERIC(15,2),
  VPROD NUMERIC(15,2),
  VFRETE NUMERIC(15,2),  
  VSEG NUMERIC(15,2),
  VDESC NUMERIC(15,2),  
  VIPI NUMERIC(15,2),
  VPIS NUMERIC(15,2), 
  VCOFINS NUMERIC(15,2),
  VOUTRO NUMERIC(15,2),
  VNF NUMERIC(15,2),
  VTOTTRIB NUMERIC(15,2),
  VICMSUFDEST NUMERIC(15,2),
  VICMSUFREMET NUMERIC(15,2),
  VFCPUFDEST NUMERIC(15,2),
  AUTCNPJ VARCHAR(14),
  AUTCPF VARCHAR(11),
  CHNFE VARCHAR(44),
  NPROT VARCHAR(20), 
  CSTAT INT,
  XMOTIVO VARCHAR(255),
  
  PRIMARY KEY (IDNFEENTRADA),
  FOREIGN KEY (IDFORNECEDOR) REFERENCES FORNECEDOR (IDFORNECEDOR),
  FOREIGN KEY (IDTRANSPORTADORA) REFERENCES TRANSPORTADORA (IDTRANSPORTADORA),
  FOREIGN KEY (IDPEDIDOCOMPRA) REFERENCES PEDIDOCOMPRA (IDPEDIDOCOMPRA)
);

CREATE TABLE ITEMNFEENTRADA (
  IDITEMNFEENTRADA NUMERIC(18,0),
  IDNFEENTRADA NUMERIC(18,0),
  IDPRODUTO NUMERIC(18,0),
  IDCONVERSAOUNIDADEDEMEDIDA NUMERIC(18,0),
  
  CEAN NUMERIC(14,0), 
  XPROD VARCHAR(120),
  NCM VARCHAR(8),
  CEST VARCHAR(7),
  CFOP VARCHAR(4),
  UCOM VARCHAR(6),
  QCOM NUMERIC(15,4),
  VUNCOM NUMERIC(15,2),
  VPROD NUMERIC(15,2),
  CEANTRIB VARCHAR(14),
  UTRIB VARCHAR(6),
  QTRIB NUMERIC(15,4),
  VUNTRIB NUMERIC(15,2),
  VFRETE NUMERIC(15,2),
  VSEG NUMERIC(15,2),
  VDESC NUMERIC(15,2),
  VOUTRO NUMERIC(15,2),
  INDTOT INT,
  VTOTTRIB NUMERIC(15,2),
  ORIG VARCHAR(1),
  CSTICMS VARCHAR(3),
  MODBC INT,
  PREDBC NUMERIC(5,4),
  VBCICMS NUMERIC(15,2),
  PICMS NUMERIC(5,4),
  VICMS NUMERIC(15,2),
  MODBCST INT,
  PMVAST NUMERIC(5,4),
  PREDBCST NUMERIC(5,4),
  VBCST NUMERIC(15,2),
  PICMSST NUMERIC(5,4),
  VICMSST NUMERIC(15,2),
  VBCUFDEST NUMERIC(15,2),
  PFCPUFDEST NUMERIC(5,4),
  PICMSUFDEST NUMERIC(5,4),
  PICMSINTER NUMERIC(5,4),
  PICMSINTERPART NUMERIC(5,4),
  VFCPUFDEST NUMERIC(15,2),
  VICMSUFDEST NUMERIC(15,2),
  VICMSUFREMET NUMERIC(15,2),
  CENQ VARCHAR(3),
  CSTIPI VARCHAR(2),
  VBCIPI NUMERIC(15,2),
  PIPI NUMERIC(5,4),
  VIPI NUMERIC(15,2),
  CSTPIS VARCHAR(2),
  VBCPIS NUMERIC(15,2),
  PPIS NUMERIC(5,4),
  VPIS NUMERIC(15,2),
  CSTCOFINS VARCHAR(2),
  VBCOFINS NUMERIC(15,2),
  PCOFINS NUMERIC(5,4),
  VCOFINS NUMERIC(15,2),
  
  PRIMARY KEY (IDITEMNFEENTRADA),
  FOREIGN KEY (IDNFEENTRADA) REFERENCES NFEENTRADA (IDNFEENTRADA),
  FOREIGN KEY (IDPRODUTO) REFERENCES PRODUTO (IDPRODUTO),
  FOREIGN KEY (IDCONVERSAOUNIDADEDEMEDIDA) REFERENCES CONVERSAOUNIDADEDEMEDIDA (IDCONVERSAOUNIDADEDEMEDIDA)
);

/* PAULO.FOLETTO EM 06/12/2017 #Novos Campos da Tabela Fornecedor */
ALTER TABLE FORNECEDOR ADD COLUMN INSCRICAOESTADUAL NUMERIC(14,0);
ALTER TABLE FORNECEDOR ADD COLUMN ISENTO NUMERIC(1);
ALTER TABLE FORNECEDOR ADD COLUMN EMAIL VARCHAR(150);
ALTER TABLE FORNECEDOR ADD COLUMN IDENDERECO NUMERIC(18,0);
ALTER TABLE FORNECEDOR ADD FOREIGN KEY (IDENDERECO) REFERENCES ENDERECO (IDENDERECO);

/* PAULO.FOLETTO EM 18/12/2017 #Nova Tabela ProdutoFornecedor Para Salvar os Códigos Do Produto Por Fornecedor */
CREATE TABLE PRODUTOFORNECEDOR (
   IDPRODUTOFORNECEDOR NUMERIC(18,0),
   IDFORNECEDOR NUMERIC(18,0),
   IDPRODUTO NUMERIC(18,0),
   CPROD VARCHAR(14),

   PRIMARY KEY (IDPRODUTOFORNECEDOR),
   FOREIGN KEY (IDFORNECEDOR) REFERENCES FORNECEDOR (IDFORNECEDOR),
   FOREIGN KEY (IDPRODUTO) REFERENCES PRODUTO (IDPRODUTO)
);

ALTER TABLE PRODUTO DROP COLUMN IDFORNECEDOR;
ALTER TABLE ITEMNFEENTRADA ADD COLUMN CPROD VARCHAR(100);

/* PAULO.FOLETTO EM 22/12/2017 #Tabelas do Download da NFe */
CREATE TABLE MANIFESTACAODESTINATARIO (
    IDMANIFESTACAODESTINATARIO NUMERIC(18,0),
    CHAVENFE VARCHAR(44),
    TIPOAMBIENTE NUMERIC(1),
    ORGAO NUMERIC(2),
    CSTAT NUMERIC(10),
    MOTIVO VARCHAR(1000),
    TIPOMANIFESTACAO NUMERIC(6),
	NUMEROEVENTO NUMERIC(5),
    
    PRIMARY KEY (IDMANIFESTACAODESTINATARIO)
);

CREATE TABLE DOWNLOADNFE(
    IDDOWNLOADNFE NUMERIC(18,0),
    IDMANIFESTACAODESTINATARIO NUMERIC(18),
    CSTAT NUMERIC(10),
    MOTIVO VARCHAR(1000),
    TPAMB NUMERIC(2),
	DHRESP TIMESTAMP,
	ULTNSU NUMERIC(15),
	MAXNSU NUMERIC(15),
    XML BYTEA,
    
    PRIMARY KEY (IDDOWNLOADNFE),
    FOREIGN KEY (IDMANIFESTACAODESTINATARIO) REFERENCES MANIFESTACAODESTINATARIO (IDMANIFESTACAODESTINATARIO)
);

/* PAULO.FOLETTO EM 22/12/2017 #Coluna da NFe de Entrada no Contas a Pagar */
ALTER TABLE CONTAPAGAR ADD COLUMN IDNFEENTRADA NUMERIC(18,0);
ALTER TABLE CONTAPAGAR ADD FOREIGN KEY (IDNFEENTRADA) REFERENCES NFEENTRADA (IDNFEENTRADA);

/* PAULO.FOLETTO EM 22/12/2017 #Colunas IDUsuario e DataImportacao da NFe */
ALTER TABLE NFEENTRADA ADD COLUMN DATAIMPORTACAO TIMESTAMP;
ALTER TABLE NFEENTRADA ADD COLUMN IDUSUARIO NUMERIC(18,0);
ALTER TABLE NFEENTRADA ADD FOREIGN KEY (IDUSUARIO) REFERENCES USUARIO (IDUSUARIO);

CREATE TABLE NFEENTRADAXML (
   IDNFEENTRADAXML NUMERIC(18,0),
   IDNFEENTRADA NUMERIC(18,0),
   XML BYTEA,

   PRIMARY KEY (IDNFEENTRADAXML),
   FOREIGN KEY (IDNFEENTRADA) REFERENCES NFEENTRADA (IDNFEENTRADA)
);

/* PAULO.FOLETTO EM 25/12/2017 #Colunas de Almoxarifado no Produto */
ALTER TABLE PRODUTO ADD COLUMN IDALMOXARIFADOENTRADA NUMERIC(18,0);
ALTER TABLE PRODUTO ADD FOREIGN KEY (IDALMOXARIFADOENTRADA) REFERENCES ALMOXARIFADO (IDALMOXARIFADO);

ALTER TABLE PRODUTO ADD COLUMN IDALMOXARIFADOSAIDA NUMERIC(18,0);
ALTER TABLE PRODUTO ADD FOREIGN KEY (IDALMOXARIFADOSAIDA) REFERENCES ALMOXARIFADO (IDALMOXARIFADO);

/* PAULO.FOLETTO EM 25/12/2017 #Tabelas de Movimentação, Transferencia e Inventário */
CREATE TABLE INVENTARIO(
   IDINVENTARIO NUMERIC(18,0),
   DATAINVENTARIO DATE,
   
   PRIMARY KEY (IDINVENTARIO)
);

CREATE TABLE ITEMINVENTARIO(
   IDITEMINVENTARIO NUMERIC(18,0),
   IDINVENTARIO NUMERIC(18,0),
   IDPRODUTO NUMERIC(18,0),
   IDALMOXARIFADO NUMERIC(18,0),
   QUANTIDADE NUMERIC(15,4),
   
   PRIMARY KEY (IDITEMINVENTARIO),
   FOREIGN KEY (IDINVENTARIO) REFERENCES INVENTARIO (IDINVENTARIO),
   FOREIGN KEY (IDPRODUTO) REFERENCES PRODUTO (IDPRODUTO),
   FOREIGN KEY (IDALMOXARIFADO) REFERENCES ALMOXARIFADO (IDALMOXARIFADO)
);

CREATE TABLE TRANSFERENCIAESTOQUE (
	IDTRANSFERENCIAESTOQUE NUMERIC(18),
	DATATRANSFERENCIA TIMESTAMP,
	OBSERVACAO TEXT,
	
	PRIMARY KEY (IDTRANSFERENCIAESTOQUE)
);

CREATE TABLE ITEMTRANSFERENCIAESTOQUE (
	IDITEMTRANSFERENCIAESTOQUE NUMERIC(18,0),
	IDTRANSFERENCIAESTOQUE NUMERIC(18,0),
	IDPRODUTO NUMERIC(18,0),
	IDALMOXARIFADOENTRADA NUMERIC(18,0),
	IDALMOXARIFADOSAIDA NUMERIC(18,0),
	QUANTIDADE NUMERIC(15,4),
	
	PRIMARY KEY (IDITEMTRANSFERENCIAESTOQUE),
	FOREIGN KEY (IDTRANSFERENCIAESTOQUE) REFERENCES TRANSFERENCIAESTOQUE (IDTRANSFERENCIAESTOQUE),
	FOREIGN KEY (IDPRODUTO) REFERENCES PRODUTO (IDPRODUTO),
	FOREIGN KEY (IDALMOXARIFADOENTRADA) REFERENCES ALMOXARIFADO (IDALMOXARIFADO),
	FOREIGN KEY (IDALMOXARIFADOSAIDA) REFERENCES ALMOXARIFADO (IDALMOXARIFADO)
);

CREATE TABLE MOVIMENTOESTOQUE(
   IDMOVIMENTOESTOQUE NUMERIC(18,0),
   IDPRODUTO NUMERIC(18,0),
   TIPO NUMERIC(1),
   IDITEMNFEENTRADA NUMERIC(18,0),
   IDITEMVENDA NUMERIC(18,0),
   IDPRODUTONFE NUMERIC(18,0),
   IDITEMINVENTARIO NUMERIC(18,0),
   IDALMOXARIFADOENTRADA NUMERIC(18,0),
   IDALMOXARIFADOSAIDA NUMERIC(18,0),
   IDITEMTRANSFERENCIAESTOQUE NUMERIC(18,0),
   QUANTIDADE NUMERIC(15,4),
   DATAMOVIMENTO TIMESTAMP,
   SALDOATUAL NUMERIC(15,4),
   
   PRIMARY KEY (IDMOVIMENTOESTOQUE),
   FOREIGN KEY (IDPRODUTO) REFERENCES PRODUTO (IDPRODUTO),
   FOREIGN KEY (IDITEMNFEENTRADA) REFERENCES ITEMNFEENTRADA (IDITEMNFEENTRADA),
   FOREIGN KEY (IDITEMVENDA) REFERENCES ITEMVENDA (IDITEMVENDA),
   FOREIGN KEY (IDPRODUTONFE) REFERENCES PRODUTONFE (IDPRODUTONFE),
   FOREIGN KEY (IDITEMINVENTARIO) REFERENCES ITEMINVENTARIO (IDITEMINVENTARIO),
   FOREIGN KEY (IDALMOXARIFADOENTRADA) REFERENCES ALMOXARIFADO (IDALMOXARIFADO),
   FOREIGN KEY (IDALMOXARIFADOSAIDA) REFERENCES ALMOXARIFADO (IDALMOXARIFADO),
   FOREIGN KEY (IDITEMTRANSFERENCIAESTOQUE) REFERENCES ITEMTRANSFERENCIAESTOQUE (IDITEMTRANSFERENCIAESTOQUE)
);

ALTER TABLE PRODUTO ADD COLUMN SALDOESTOQUE NUMERIC(15,4) DEFAULT 0;

/* PAULO.FOLETTO EM 06/01/2018 #Coluna para guardar o saldo atual do Almoxarifado. */
ALTER TABLE MOVIMENTOESTOQUE ADD COLUMN SALDOALMOXARIFADO NUMERIC(15,4);
ALTER TABLE PRODUTO ADD COLUMN VENDERSEMSALDO NUMERIC(1);

ALTER TABLE MOVIMENTOESTOQUE DROP COLUMN IDALMOXARIFADOSAIDA;
ALTER TABLE MOVIMENTOESTOQUE RENAME COLUMN IDALMOXARIFADOENTRADA TO IDALMOXARIFADO;